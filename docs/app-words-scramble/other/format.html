<div>
  Text
  <textarea id="textarea"></textarea>
  <button onclick="submit()">Submit</button>
  <br />
  JSON
  <textarea id="textarea2"></textarea>
  <button onclick="submit2()">Submit2</button>
  <br />

  Main JSON OBJ For home page
  <textarea id="textarea3"></textarea>
  <button onclick="submit3()">Submit3</button>
  <div id="show"></div>
  <div id="show2"></div>
  <div id="show3"></div>
</div>

<script type="text/javascript">
  function submit2() {
    let html = "";
    JSON.parse(document.getElementById("textarea2").value).map((v) => {
      html += "subl " + v.trim().replace(/ /g, "_") + ".json" + "\n";
      document.getElementById("show2").innerHTML = html;
    });
  }

  function submit3() {
    let Things = JSON.parse(document.getElementById("textarea3").value);
    console.log(Things);
    for (var i = Things.length - 1; i >= 0; i--) {
      Things[i].relatedTo = Things[i].relatedTo.sort();
      Things[i].category = capitalizeFirstLetter(Things[i].category);
      for (var jjj = Things[i].relatedTo.length - 1; jjj >= 0; jjj--) {
        let splits = Things[i].relatedTo[jjj].split(" ");
        Things[i].relatedTo[jjj] = "";
        for (var kkk = 0; kkk < splits.length; kkk++) {
          Things[i].relatedTo[jjj] += capitalizeFirstLetter(splits[kkk]) + " ";
        }
        Things[i].relatedTo[jjj] = Things[i].relatedTo[jjj].trim();
      }
    }

    Things = Things.sort((a, b) => a.category.localeCompare(b.category));

    document.getElementById("show3").innerHTML = JSON.stringify(Things);
    return Things;
  }

  function capitalizeFirstLetter(string) {
    return string.charAt(0).toUpperCase() + string.slice(1);
  }

  function crateJSON(data) {
    let words = data
      .toUpperCase()
      .replace(/\n/g, ",")
      .replace(/,,/g, ",")
      .replace(/,/g, ", ")
      .split(",");
    for (let i = words.length - 1; i >= 0; i--) {
      words[i] = words[i].trim();
    }

    let unique_words = words.filter((item, i, ar) => ar.indexOf(item) === i);
    console.log(unique_words);

    const json = {
      words: unique_words.map((word) => ({
        name: word.trim(),
      })),
    };
    for (let i = words.length - 1; i >= 0; i--) {
      if (!words[i].trim()) {
        delete words[i];
      }
    }

    document.getElementById("show").innerHTML = JSON.stringify(json);
    console.log(json);
  }

  function submit() {
    crateJSON(document.getElementById("textarea").value.trim());
  }
</script>
